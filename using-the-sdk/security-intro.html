<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Configuring site security | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Configuring site security | PnP Core SDK ">
    <meta name="generator" content="docfx 2.56.5.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/pnpcore/blob/dev/docs/using-the-sdk/security-intro.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="configuring-site-security">Configuring site security</h1>

<p>In SharePoint the definition of what a user or group can do on a securable object (Web, List, ListItem) is defined as a role (a.k.a. permission level). For example the role &quot;Full Control&quot; has many permissions like &quot;Manage Lists&quot;, &quot;View Items&quot; and more. The default <strong>owners</strong> group of a site has the &quot;Full Control&quot; role granting all users and groups part of the <strong>owners</strong> group the related permissions like &quot;Manage Lists&quot;, &quot;View Items&quot; and more. Roles are always managed at the root web level, meaning there's only one set of roles defined per site collection.</p>
<p>By default securable objects inherit permissions: the permissions set on the site are inherited by each list and the are again inherited by each list item. If a user is then added to the site's contributors group he immediately has the &quot;Full Control&quot; role on all of the content in the site. However, sometimes it's need to provide other permissions for a sub site, for a list or for a list item which is implemented by breaking the permission inheritance for the securable object followed by setting the correct permissions on the securable object.</p>
<h2 id="configuring-roles">Configuring roles</h2>
<h3 id="listing-the-existing-roles">Listing the existing roles</h3>
<p>To query the roles defined on the <code>IWeb</code> instance load the <code>RoleDefinitions</code> property on the root web of the site collection.</p>
<pre><code class="lang-csharp">var roleDefinitions = (await context.Web.GetAsync(p =&gt; p.RoleDefinitions)).RoleDefinitions;
foreach(role in roleDefinitions)
{
    // do something with the role
    // Typical roles are &quot;Full Control&quot;, &quot;Edit&quot;, &quot;Contribute&quot;, ...
}
</code></pre>
<h3 id="understanding-if-a-role-has-a-permission">Understanding if a role has a permission</h3>
<p>To verify if a role has a given permission level you can use</p>
<pre><code class="lang-csharp">// Context is a root web context
var roleDefinition = await context.Web.RoleDefinitions.FirstOrDefaultAsync(d =&gt; d.Name == &quot;Full Control&quot;);
if (roleDefinition.BasePermissions.Has(PermissionKind.ViewPages))
{
    // The &quot;Full Control&quot; role has the &quot;View Pages&quot; permission
}
</code></pre>
<h3 id="adding-a-custom-role">Adding a custom role</h3>
<p>If the default roles and their associated permissions do not fit your needs you can create a new role.</p>
<div class="NOTE">
<h5>Note</h5>
<p>It's not recommended to change the out of the box provided roles.</p>
</div>
<pre><code class="lang-csharp">// Load the roles, context is a root web context
var roleDefinitions = (await context.Web.GetAsync(p =&gt; p.RoleDefinitions)).RoleDefinitions;
// Add a custom role
var customRole = await roleDefinitions.AddAsync(&quot;My custom role&quot;, 
                                                RoleType.None, 
                                                new PermissionKind[] 
                                                { 
                                                    PermissionKind.ViewPages, 
                                                    PermissionKind.ViewListItems 
                                                }, 
                                                &quot;Limited viewing only&quot;);
</code></pre>
<h3 id="updating-a-role">Updating a role</h3>
<p>A role can also be updated, simply call one of the <code>Update</code> methods after having changed the role. The change the permissions a role has use the <code>Clear</code> and <code>Set</code> methods on the <code>BasePermissions</code> property:</p>
<pre><code class="lang-csharp">customRole = await context.Web.RoleDefinitions.FirstOrDefaultAsync(d =&gt; d.Name == &quot;My custom role&quot;);

customRole.BasePermissions.Clear(PermissionKind.ViewPages);
customRole.BasePermissions.Set(PermissionKind.AddListItems);
customRole.Description = &quot;Custom role&quot;;
// Send update to server
await customRole.UpdateAsync();
</code></pre>
<h3 id="deleting-a-role">Deleting a role</h3>
<p>Deleting a role can be done via the <code>Delete</code> methods:</p>
<pre><code class="lang-csharp">customRole = await context.Web.RoleDefinitions.FirstOrDefaultAsync(d =&gt; d.Name == &quot;My custom role&quot;);
// Delete the role
await customRole.DeleteAsync();
</code></pre>
<h2 id="assigning-roles">Assigning roles</h2>
<p>To actually grant a permission a role needs to be associated to a user or group. By default the groups and user and their associated roles are maintained at the root web level, but it's possible to break permission inheritance and have different permissions at sub web, list or list item level.</p>
<h3 id="assigningremoving-role-for-a-user-or-group-at-web-level">Assigning/removing role for a user or group at web level</h3>
<p>todo</p>
<pre><code class="lang-csharp">
</code></pre>
<h3 id="configure-web-list-or-list-item-to-use-unique-permissions">Configure web, list or list item to use unique permissions</h3>
<p>todo</p>
<pre><code class="lang-csharp">
</code></pre>
<h3 id="assigningremoving-role-for-a-user-or-group-at-list-level">Assigning/removing role for a user or group at list level</h3>
<p>todo</p>
<pre><code class="lang-csharp">
</code></pre>
<h3 id="assigningremoving-role-for-a-user-or-group-at-list-item-level">Assigning/removing role for a user or group at list item level</h3>
<p>todo</p>
<pre><code class="lang-csharp">
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>